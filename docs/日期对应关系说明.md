# 默默上涨盈亏计算的日期对应关系说明

## 当前实现（N=1，buy_days_before=1）

### 示例：当前日期是10号

**X轴日期10号对应的内容：**

1. **股票列表**（默默上涨折线上的点）：
   - 显示的是：**10号当天选出的股票**
   - 来源：`momo_results` 中日期为10号的股票列表
   - 这个没问题，和X轴日期对齐 ✅

2. **平均盈亏**（盈亏折线上的点）：
   - 计算的是：**8号选出的股票，9号买入，10号卖出**的平均盈亏
   - 选股日 = 10 - (1+1) = **8号**
   - 买入日 = **9号**
   - 卖出日 = **10号**（当前日期）
   - ⚠️ **错位问题**：X轴是10号，但计算的是8号选出的股票

3. **每只股票括号内的"隔日盈亏"**：
   - 显示的是：**如果这只股票在8号被选出，9号买入，10号卖出**的盈亏
   - ⚠️ **错位问题**：X轴10号显示的股票是10号选出的，但盈亏是8号选出的股票的盈亏

## 日期对应关系表（N=1）

| X轴日期 | 显示的股票列表 | 平均盈亏计算 | 每只股票的"隔日盈亏" |
|---------|---------------|-------------|---------------------|
| 8号     | 8号选出的股票  | 6号选出，7号买入，8号卖出 | 6号选出，7号买入，8号卖出 |
| 9号     | 9号选出的股票  | 7号选出，8号买入，9号卖出 | 7号选出，8号买入，9号卖出 |
| 10号    | 10号选出的股票 | **8号选出，9号买入，10号卖出** | **8号选出，9号买入，10号卖出** |
| 11号    | 11号选出的股票 | 9号选出，10号买入，11号卖出 | 9号选出，10号买入，11号卖出 |

## 问题分析

**当前逻辑的问题：**
- X轴日期t显示的股票是t日选出的
- 但盈亏计算的是t-2日选出的股票（t-1日买入，t日卖出）
- 导致股票列表和盈亏数据不对应

**用户期望的逻辑：**
- X轴日期t显示的股票是t日选出的
- 盈亏应该是：t-1日选出的股票，t日买入，t+1日卖出的盈亏
- 但这个盈亏只有在t+1日才能知道

## 解决方案

如果要让股票列表和盈亏对齐，有两种方案：

### 方案1：在日期t+1显示t-1日选出的股票的盈亏
- X轴日期t+1显示的股票：t+1日选出的股票
- 平均盈亏：t-1日选出的股票，t日买入，t+1日卖出的盈亏
- 问题：股票列表和盈亏还是不对应

### 方案2：在日期t显示t-2日选出的股票的盈亏（当前实现）
- X轴日期t显示的股票：t日选出的股票
- 平均盈亏：t-2日选出的股票，t-1日买入，t日卖出的盈亏
- 问题：股票列表和盈亏不对应

### 方案3：在日期t显示t-1日选出的股票列表和盈亏（推荐）
- X轴日期t显示的股票：t-1日选出的股票（而不是t日选出的）
- 平均盈亏：t-1日选出的股票，t日买入，t+1日卖出的盈亏
- 但这个盈亏只有在t+1日才能计算，所以需要延迟一天显示

