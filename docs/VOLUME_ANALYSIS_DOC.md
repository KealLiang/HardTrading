# 成交量涨跌幅分析功能说明

## 功能概述

成交量涨跌幅分析功能是对现有【涨停梯队 按概念分组】sheet的扩展，提供了基于成交量变化的分析视角。

## 主要特点

### 1. 数据结构一致性
- 与【涨停梯队 按概念分组】sheet的数据和结构完全一样
- 相同的股票列表、概念分组、日期范围
- 相同的表头和布局

### 2. 核心差异
- **原版本**：每个单元格显示股价涨跌幅（如：+5.2%）
- **成交量版本**：每个单元格显示成交量涨跌幅（如：+120.5%）

### 3. 成交量涨跌幅计算
```
成交量涨跌幅 = (当日成交量 - 前一日成交量) / 前一日成交量 × 100%
```

### 4. 颜色映射
成交量变化的颜色梯度专门针对成交量特点设计：

#### 放量（正值）- 红色系
- ≥300%：深红色（极度放量）
- ≥200%：中红色（大幅放量）  
- ≥100%：浅红色（明显放量）
- ≥50%：极浅红色（适度放量）
- ≥0%：极浅绿色（微量增加）

#### 缩量（负值）- 绿色系
- ≥-30%：浅绿色（轻微缩量）
- ≥-50%：中绿色（明显缩量）
- ≥-70%：深绿色（大幅缩量）
- <-70%：极深绿色（极度缩量）

## 使用方法

### 1. 启用成交量分析
在 `main.py` 的 `generate_ladder_chart()` 函数中：

```python
def generate_ladder_chart():
    # ... 其他参数 ...
    create_volume_sheet = True  # 设置为True启用成交量分析
    
    build_ladder_chart(
        # ... 其他参数 ...
        create_volume_sheet=create_volume_sheet
    )
```

### 2. 生成的工作表
启用后会在Excel文件中创建名为 `{原sheet名}_成交量分析` 的新工作表。

例如：
- 原工作表：`涨停梯队202507_按概念分组`
- 成交量工作表：`涨停梯队202507_按概念分组_成交量分析`

## 分析价值

### 1. 资金流向分析
- 通过成交量变化识别资金进出情况
- 放量上涨通常表示资金积极介入
- 缩量下跌可能表示抛压减轻

### 2. 趋势确认
- 价涨量增：趋势健康
- 价涨量缩：可能存在分歧
- 价跌量增：可能有恐慌性抛售
- 价跌量缩：可能接近底部

### 3. 概念轮动
- 对比不同概念板块的成交量变化
- 识别资金流向的概念偏好
- 发现新兴热点概念

## 技术实现

### 1. 模块化设计
- 新功能独立实现在 `analysis/volume_ladder_chart.py`
- 不影响现有功能的稳定性
- 可以独立测试和维护

### 2. 数据复用
- 复用现有的股票筛选逻辑
- 复用现有的概念分组逻辑
- 复用现有的日期处理逻辑

### 3. 性能优化
- 使用缓存机制减少重复计算
- 批量处理提高效率

## 注意事项

### 1. 数据依赖
- 需要有完整的历史成交量数据
- 停牌股票会显示"停牌"
- 数据缺失时不显示成交量涨跌幅

### 2. 解读建议
- 成交量变化幅度通常比股价变化幅度大
- 需要结合股价变化一起分析
- 关注异常放量或缩量的情况

### 3. 使用场景
- 适合短线交易者关注资金流向
- 适合分析概念板块的活跃度
- 适合识别主力资金的操作痕迹

## 示例分析

假设某股票在连续几天的表现：
- Day1: 股价+5.2%, 成交量+150%（放量上涨，资金积极）
- Day2: 股价+2.1%, 成交量-20%（缩量上涨，可能分歧）
- Day3: 股价-3.5%, 成交量+80%（放量下跌，可能有抛压）
- Day4: 股价-1.2%, 成交量-60%（缩量下跌，抛压减轻）

通过这种分析可以更好地理解股票的资金流向和市场情绪变化。
